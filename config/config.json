{
  "$schema": "./config.schema.json",

  "benchmark": {
    "base_url": "http://localhost:8080",
    "workers": 50,
    "requests": 5000,
    "timeout": "10s",
    "cooldown": "1s",
    "warmup": 50
  },

  "container": {
    "cpu": "2.0",
    "memory": "1gb"
  },

  "capacity": {
    "min_workers": 1,
    "max_workers": 4096,
    "precision": "1%",
    "success_rate": "95%",
    "p99_threshold": "50ms",
    "warmup": "2s",
    "measure": "10s"
  },

  "influx": {
    "url": "http://localhost:8181",
    "database": "benchmarks",
    "token": "benchmark-token",
    "sample_rate": "10%"
  },

  "databases": ["postgres", "mongodb", "redis", "cassandra"],

  "servers": [
    { "name": "express", "image": "node-express", "port": 3001 },
    { "name": "nestjs", "image": "node-nestjs", "port": 3002 },
    { "name": "fastify", "image": "node-fastify", "port": 3003 },
    { "name": "oak", "image": "deno-oak", "port": 3004 },
    { "name": "honojs", "image": "bun-honojs", "port": 3005 },
    { "name": "elysia", "image": "bun-elysia", "port": 3006 },
    { "name": "fastapi", "image": "python-fastapi", "port": 4001 },
    { "name": "chi", "image": "go-chi", "port": 5001 },
    { "name": "gin", "image": "go-gin", "port": 5002 },
    { "name": "fiber", "image": "go-fiber", "port": 5003 }
  ],

  "endpoints": {
    "root": {
      "route": "GET /",
      "expect": { "status": 200, "text": "OK" }
    },

    "health": {
      "route": "GET /health",
      "expect": {
        "status": 200,
        "body": {
          "status": "healthy",
          "databases": {
            "postgres": "healthy",
            "mongodb": "healthy",
            "redis": "healthy",
            "cassandra": "healthy"
          }
        }
      }
    },

    "params_search": {
      "path": "/params/search",
      "method": "GET",
      "expect": { "status": 200, "body": { "search": "none", "limit": 10 } },
      "variations": [
        { "query": { "q": "hello", "limit": "5" }, "expect": { "body": { "search": "hello", "limit": 5 } } },
        { "query": { "q": "  trimmed  ", "limit": "20" }, "expect": { "body": { "search": "trimmed", "limit": 20 } } },
        { "query": { "q": "test", "limit": "abc" }, "expect": { "body": { "search": "test", "limit": 10 } } }
      ]
    },

    "params_url": {
      "path": "/params/url/testvalue",
      "method": "GET",
      "expect": { "status": 200, "body": { "dynamic": "testvalue" } },
      "variations": [
        { "path": "/params/url/12345", "expect": { "body": { "dynamic": "12345" } } },
        { "path": "/params/url/hello-world_123", "expect": { "body": { "dynamic": "hello-world_123" } } }
      ]
    },

    "params_header": {
      "path": "/params/header",
      "method": "GET",
      "expect": { "status": 200, "body": { "header": "none" } },
      "variations": [
        { "headers": { "X-Custom-Header": "my-custom-value" }, "expect": { "body": { "header": "my-custom-value" } } },
        { "headers": { "X-Custom-Header": "  trimmed  " }, "expect": { "body": { "header": "trimmed" } } }
      ]
    },

    "params_body": {
      "path": "/params/body",
      "method": "POST",
      "body": { "key": "value" },
      "expect": { "status": 200, "body": { "body": { "key": "value" } } },
      "variations": [
        {
          "body": { "user": { "name": "John", "age": 30 } },
          "expect": { "body": { "body": { "user": { "name": "John", "age": 30 } } } }
        },
        { "body": { "items": ["a", "b", "c"] }, "expect": { "body": { "body": { "items": ["a", "b", "c"] } } } }
      ]
    },

    "params_cookie": {
      "path": "/params/cookie",
      "method": "GET",
      "expect": { "status": 200, "body": { "cookie": "none" } },
      "variations": [
        { "headers": { "Cookie": "foo=bar" }, "expect": { "body": { "cookie": "bar" } } },
        { "headers": { "Cookie": "foo=  spaced  " }, "expect": { "body": { "cookie": "spaced" } } }
      ]
    },

    "params_form": {
      "path": "/params/form",
      "method": "POST",
      "form_data": { "name": "John", "age": "25" },
      "expect": { "status": 200, "body": { "name": "John", "age": 25 } },
      "variations": [
        { "form_data": { "name": "  Jane  ", "age": "30" }, "expect": { "body": { "name": "Jane", "age": 30 } } }
      ]
    },

    "params_file": {
      "path": "/params/file",
      "method": "POST",
      "file": "test.txt",
      "expect": { "status": 200, "body": { "filename": "test.txt", "size": 14, "content": "Hello, World!\n" } },
      "variations": [
        {
          "file": "multi.txt",
          "expect": { "body": { "filename": "multi.txt", "size": 21, "content": "Line 1\nLine 2\nLine 3\n" } }
        }
      ]
    },

    "crud_create": {
      "route": "POST /db/{database}/users",
      "body": { "name": "Test User", "email": "{unique_email}", "favoriteNumber": "{favorite_number}" },
      "expect": { "status": 201, "body": { "email": "{unique_email}" } },
      "per_database": true,
      "flow": {
        "id": "crud",
        "capture": { "id": "id" },
        "vars": {
          "unique_email": { "type": "email" },
          "favorite_number": { "type": "int", "min": 0, "max": 100, "optional": true }
        }
      }
    },

    "crud_read": {
      "route": "GET /db/{database}/users/{id}",
      "expect": { "status": 200, "body": { "email": "{unique_email}" } },
      "per_database": true,
      "flow": { "id": "crud" }
    },

    "crud_update": {
      "route": "PATCH /db/{database}/users/{id}",
      "body": { "name": "Updated User" },
      "expect": { "status": 200 },
      "per_database": true,
      "flow": { "id": "crud" }
    },

    "crud_delete": {
      "route": "DELETE /db/{database}/users/{id}",
      "expect": { "status": 200 },
      "per_database": true,
      "flow": { "id": "crud" }
    }
  }
}
